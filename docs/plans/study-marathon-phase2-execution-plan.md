# Study Marathon Phase2 実行計画書

本ドキュメントは、`docs/plans/study-marathon-mvp-execution-plan.md` の Phase2
「学習記録 CRUD (ログイン前提なし・自分用の簡易CRUD)」を具体的な実装タスクに落とし込んだ実行計画です。

---

## Phase2: 学習記録 CRUD (ログイン前提なし・自分用の簡易CRUD)

- **目的**
  - 「学習時間の記録」「自分の記録一覧」の基本的な CRUD をログインなしで先に完成させ、画面の流れとバリデーションを固める。

- **前提**
  - Phase1 までに `Users` / `StudyLogs` Entity と Repository が最低限整備されていること。
  - セキュリティ設定として、Phase2 では学習記録画面へのアクセスはログイン不要でよい(後続Phaseで変更予定)。

---

## タスク一覧 (チェックボックス)

### 1. 設計・ルーティング整理

- [x] 2-1. 学習記録用 URL を決定する。
      例: 一覧表示用 `GET /study-logs`、登録処理用 `POST /study-logs`、削除処理用 `POST /study-logs/{id}/delete` など。
- [x] 2-2. 固定ユーザー or 仮ユーザーID(例: `user_id = 1`)で進める方針をメモに残す。

### 2. Controller 層の実装

- [x] 2-3. 学習記録一覧を表示する Controller メソッドを作成する。
      Repository から全件 or 上位N件を取得し、Model に詰めて View に渡す。
- [x] 2-4. 新規登録用フォームから送信された値を受け取る Controller メソッドを実装する。
      バリデーションエラー時は同じ画面に戻し、成功時は一覧へリダイレクトする。
- [x] 2-5. 削除ボタン押下時の Controller メソッドを実装する。
      該当IDの学習記録を削除し、一覧画面へリダイレクトする。

### 3. Service 層の実装

- [x] 2-6. 学習記録の登録・取得・削除を行う Service クラスを作成する。
- [x] 2-7. Controller から直接 Repository を呼び出さず、Service を経由するようにする。

### 4. Repository 層の実装

- [x] 2-8. `StudyLogs` 用 Repository インターフェースを作成する。
      一覧取得・ID 指定削除など、Phase2 で必要なメソッドを定義する。

### 5. 画面(Thymeleaf)の作成

- [x] 2-9. 学習記録一覧 + 登録フォームを表示するテンプレート(例: `study_logs/index.html`)を作成する。
- [x] 2-10. 画面上部に「日付」「分数」「内容」を入力するフォームを配置する。
- [x] 2-11. 画面下部に登録済みの学習記録一覧テーブルを表示し、各行に削除ボタンを配置する。

### 6. 入力バリデーション

- [x] 2-12. 学習記録入力用のフォームクラス(例: DTO or Form オブジェクト)を作成する。
- [x] 2-13. 「日付」「分数」「内容」に対して以下のようなバリデーションを設定する。
      - 日付: 未入力禁止、未来日禁止(必要に応じて)
      - 分数: 0 以下にならないこと、上限値(例: 1440 分)を超えないこと
      - 内容: 必須・最大文字数の制限
- [x] 2-14. バリデーションエラー時にフォーム上でエラーメッセージを表示する。

### 7. 動作確認

- [ ] 2-15. 正常系: 正しい値を入力して登録 → 一覧に即座に反映されることを確認する。
- [ ] 2-16. 削除系: 一覧の削除ボタンを押下 → 対象行が削除されることを確認する。
- [ ] 2-17. 異常系: 分数を0以下・非常に大きな値・未入力などにして登録 → エラー表示され登録されないことを確認する。
- [ ] 2-18. ブラウザのリロードや戻る操作で、二重登録などの問題が発生しないか軽く確認する。

---

## UI確認ポイント

- ブラウザからフォームに「日付」「分数」「内容」を入力し、登録ボタンで即座に下部の一覧に反映される。
- 一覧から削除ボタンを押すと、その行の記録が削除される。

---

## メモ (必要に応じて追記)

- 固定ユーザー / 仮ユーザーID の扱い
- 一覧表示件数(N件にするか全件にするか)
- 後続Phase(Spring Security導入・ユーザー紐付け)で変更予定のポイント
